# 打印机选择功能测试清单

**版本**: v2.4 - 多打印机支持  
**测试日期**: _____________  
**测试人员**: _____________  
**设备型号**: _____________  
**Android版本**: _____________  

---

## 📋 安装前检查

- [ ] 手机通过 USB 连接到物理机
- [ ] 手机已开启 "开发者选项"
- [ ] 手机已开启 "USB 调试"
- [ ] 物理机上已安装 ADB 工具
- [ ] APK 文件存在: `app\build\outputs\apk\debug\app-debug.apk`
- [ ] 打印机 AQ-V258007640 已开机
- [ ] 手机蓝牙已开启

---

## 📦 安装测试

### 测试项 1: ADB 设备检测
**命令**: `.\adb.exe devices`  
**预期结果**: 显示设备序列号和 "device" 状态

- [ ] ✅ 通过 / ❌ 失败

**实际结果**: 
```

```

---

### 测试项 2: 旧版本卸载
**命令**: `.\adb.exe uninstall com.nfc.app`  
**预期结果**: Success 或 "未安装旧版本"

- [ ] ✅ 通过 / ❌ 失败 / ⚠️ 跳过

**实际结果**: 
```

```

---

### 测试项 3: 新版本安装
**命令**: `.\adb.exe install "app\build\outputs\apk\debug\app-debug.apk"`  
**预期结果**: Success

- [ ] ✅ 通过 / ❌ 失败

**实际结果**: 
```

```

---

### 测试项 4: 应用启动
**命令**: `.\adb.exe shell am start -n com.nfc.app/.MainActivity`  
**预期结果**: 应用正常打开,显示主界面

- [ ] ✅ 通过 / ❌ 失败

**实际结果**: 
```

```

---

## 🔧 功能测试

### 测试项 5: NFC 读卡
**操作**: 将 NFC 卡靠近手机

**预期结果**:
- 卡号自动填充
- 机号自动获取
- 单位名称自动填充

- [ ] ✅ 通过 / ❌ 失败

**实际结果**: 
```
卡号: ___________________
机号: ___________________
单位: ___________________
```

---

### 测试项 6: 蓝牙打印机配对检查
**操作**: 
1. 进入手机 "设置" → "蓝牙"
2. 查看已配对设备列表

**预期结果**: 
- 显示 AQ-V258007640 或其他 AQ-V 打印机
- 状态为 "已配对"

- [ ] ✅ 通过 / ❌ 失败

**已配对的打印机**:
```
1. _____________________ (地址: ___________________)
2. _____________________ (地址: ___________________)
3. _____________________ (地址: ___________________)
```

---

## 🖨️ 打印功能测试

### 场景 A: 单个打印机环境

**前提条件**: 
- [ ] 手机仅配对1个 AQ-V 打印机
- [ ] 打印机已开机
- [ ] 已读取 NFC 卡
- [ ] 已填写金额

**测试步骤**:
1. 点击 "确认" 按钮
2. 观察应用行为

**预期结果**:
- [ ] 不显示打印机选择对话框
- [ ] 自动连接打印机
- [ ] 打印第1份小票
- [ ] 等待约2秒
- [ ] 打印第2份小票
- [ ] 显示 "2份小票打印完成"

**实际结果**: 
- [ ] ✅ 完全符合 / ⚠️ 部分符合 / ❌ 不符合

**详细记录**:
```
打印机名称: ___________________
打印机地址: ___________________
第1份小票: [ ] 成功 / [ ] 失败
第2份小票: [ ] 成功 / [ ] 失败
耗时: _______ 秒
```

---

### 场景 B: 多个打印机环境

**前提条件**: 
- [ ] 手机配对了多个 AQ-V 打印机
- [ ] 所有打印机已开机
- [ ] 已读取 NFC 卡
- [ ] 已填写金额

**测试步骤**:
1. 点击 "确认" 按钮
2. 观察是否弹出选择对话框

**预期结果**:
- [ ] 显示打印机选择对话框
- [ ] 对话框标题: "选择打印机"
- [ ] 列出所有已配对的 AQ-V 打印机
- [ ] 每个打印机显示2行: 名称 + 地址
- [ ] 有 "取消" 按钮

**实际结果**: 
- [ ] ✅ 完全符合 / ⚠️ 部分符合 / ❌ 不符合

**对话框截图或记录**:
```
显示的打印机:
1. _____________________ (地址: ___________________)
2. _____________________ (地址: ___________________)
3. _____________________ (地址: ___________________)
```

---

**测试步骤 (续)**:
3. 选择 AQ-V258007640
4. 观察打印过程

**预期结果**:
- [ ] 对话框关闭
- [ ] 开始连接选中的打印机
- [ ] 打印第1份小票
- [ ] 等待约2秒
- [ ] 打印第2份小票
- [ ] 显示 "2份小票打印完成"

**实际结果**: 
- [ ] ✅ 完全符合 / ⚠️ 部分符合 / ❌ 不符合

**详细记录**:
```
选择的打印机: ___________________
连接时间: _______ 秒
第1份小票: [ ] 成功 / [ ] 失败
第2份小票: [ ] 成功 / [ ] 失败
总耗时: _______ 秒
```

---

### 场景 C: 未配对打印机

**前提条件**: 
- [ ] 手机未配对任何 AQ-V 打印机
- [ ] 已读取 NFC 卡
- [ ] 已填写金额

**测试步骤**:
1. 点击 "确认" 按钮
2. 观察应用提示

**预期结果**:
- [ ] 显示对话框
- [ ] 标题: "未找到打印机"
- [ ] 内容包含配对指引
- [ ] 有 "去配对" 按钮
- [ ] 有 "取消" 按钮

**实际结果**: 
- [ ] ✅ 完全符合 / ⚠️ 部分符合 / ❌ 不符合

---

**测试步骤 (续)**:
3. 点击 "去配对" 按钮
4. 观察跳转

**预期结果**:
- [ ] 自动打开手机蓝牙设置页面
- [ ] 可以在设置中搜索并配对打印机

**实际结果**: 
- [ ] ✅ 通过 / ❌ 失败

---

## 📄 小票质量检查

### 检查项 1: 小票格式
**检查第1份和第2份小票**:

- [ ] 顶部有约1cm空白
- [ ] 标题 "缴费小票" 居中显示
- [ ] 标题字体明显大于内容
- [ ] 卡号正确显示
- [ ] 机号正确显示
- [ ] 单位名称正确显示
- [ ] 设备名称正确显示
- [ ] 金额正确显示
- [ ] 日期时间正确显示
- [ ] 底部有 "客户签字:___________________"

**小票样本照片或扫描**:
```
(粘贴照片或描述)
```

---

### 检查项 2: 2份小票对比
- [ ] 2份小票内容完全一致
- [ ] 打印质量一致
- [ ] 无缺字或乱码
- [ ] 无重叠或模糊

**差异记录** (如有):
```

```

---

## 📊 日志检查

### 日志采集
**命令**: `.\adb.exe logcat -v time | findstr "PuQuPrinterManager NFCApp MainActivity"`

**关键日志检查**:
- [ ] 显示 "找到 X 个已配对的打印机"
- [ ] 显示打印机名称和地址列表
- [ ] 显示 "用户选择打印机: ___________"
- [ ] 显示 "========== 打印到指定打印机 =========="
- [ ] 显示 "✓ 打印机已连接"
- [ ] 显示 "✓✓✓ 打印成功" (出现2次)
- [ ] 显示 "✓ 第1份小票打印成功"
- [ ] 显示 "✓ 第2份小票打印成功"

**日志片段** (复制关键部分):
```



```

---

## 🐛 异常情况测试

### 测试项 7: 打印机关机状态
**操作**: 
1. 关闭打印机
2. 点击 "确认" 按钮

**预期结果**:
- [ ] 显示 "连接超时" 错误
- [ ] 提示检查打印机是否开机

**实际结果**: 
- [ ] ✅ 通过 / ❌ 失败

---

### 测试项 8: 打印机超出范围
**操作**: 
1. 将打印机移到5米以外
2. 点击 "确认" 按钮

**预期结果**:
- [ ] 显示 "连接超时" 错误
- [ ] 或显示 "连接失败" 错误

**实际结果**: 
- [ ] ✅ 通过 / ❌ 失败

---

### 测试项 9: 打印机缺纸
**操作**: 
1. 取出打印纸
2. 点击 "确认" 按钮

**预期结果**:
- [ ] 打印机警告灯闪烁
- [ ] 应用显示打印失败 (如能检测到)
- [ ] 或显示打印成功但实际无输出

**实际结果**: 
- [ ] ✅ 通过 / ❌ 失败

---

### 测试项 10: 中途取消
**操作**: 
1. 点击 "确认" 按钮
2. 在选择对话框中点击 "取消"

**预期结果**:
- [ ] 对话框关闭
- [ ] 不进行打印
- [ ] 界面回到填写状态

**实际结果**: 
- [ ] ✅ 通过 / ❌ 失败

---

## 📈 性能测试

### 测试项 11: 连接速度
**测试方法**: 
1. 记录点击 "确认" 到打印第1份的时间
2. 重复测试3次取平均值

**测试结果**:
```
第1次: _______ 秒
第2次: _______ 秒
第3次: _______ 秒
平均: _______ 秒
```

**评价**:
- [ ] 优秀 (< 5秒)
- [ ] 良好 (5-10秒)
- [ ] 一般 (10-20秒)
- [ ] 较慢 (> 20秒)

---

### 测试项 12: 连续打印测试
**测试方法**: 
1. 连续点击 "确认" 3次
2. 观察是否每次都成功打印2份

**测试结果**:
```
第1次: [ ] 成功 (2份) / [ ] 部分成功 (_份) / [ ] 失败
第2次: [ ] 成功 (2份) / [ ] 部分成功 (_份) / [ ] 失败
第3次: [ ] 成功 (2份) / [ ] 部分成功 (_份) / [ ] 失败
```

**总计**: 应打印6份,实际打印 ____ 份

---

## ✅ 测试结论

### 通过率统计
- 安装测试: ____ / 4 项通过
- 功能测试: ____ / 3 场景通过
- 异常测试: ____ / 4 项通过
- 性能测试: ____ / 2 项通过

**总通过率**: ______%

---

### 关键问题记录
1. ____________________________________________________________
2. ____________________________________________________________
3. ____________________________________________________________

---

### 改进建议
1. ____________________________________________________________
2. ____________________________________________________________
3. ____________________________________________________________

---

### 最终评价
- [ ] ✅ 通过 - 可以部署使用
- [ ] ⚠️ 有条件通过 - 存在小问题但不影响核心功能
- [ ] ❌ 不通过 - 存在严重问题,需要修复

---

**测试签名**: _________________  
**审核签名**: _________________  
**日期**: _______________
