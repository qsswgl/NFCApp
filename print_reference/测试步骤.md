# 🧪 BLE打印机SDK测试步骤

## 📱 当前状态
- ✅ APK已安装到手机
- ✅ 应用已启动
- ✅ 扫描到AQ打印机: `AQ-V258000114(BLE)`
- ✅ SDK已初始化

---

## 🔍 完整测试流程

### 步骤1: 扫描设备 ✅ (已完成)
您已经成功扫描到设备,包括:
- **AQ-V258000114(BLE)** ⭐ (这是我们要测试的AQ打印机)
- L3250 Series
- Q_BASH_D1777079E9E7
- 等其他设备

### 步骤2: 连接AQ打印机 ⚠️ (请现在执行)

**操作说明:**
1. 在手机屏幕上,找到设备列表中的 **AQ-V258000114(BLE)**
2. **点击**这个设备项
3. 会弹出对话框显示:
   ```
   连接设备
   
   检测到AQ设备,将使用SDK模式连接
   设备: AQ-V258000114(BLE)
   
   [连接] [取消]
   ```
4. 点击 **[连接]** 按钮

**预期结果:**
- 连接状态显示: "连接中... (SDK模式)"
- 几秒后变为: **"已连接 (SDK模式 - 就绪)"**
- 卡片背景变为**绿色**
- "测试打印"按钮**变为可用**
- 弹出提示: "SDK连接成功,可以打印"

### 步骤3: 测试打印 (连接成功后执行)

**操作说明:**
1. 确认连接状态显示 "已连接 (SDK模式 - 就绪)"
2. 点击 **"测试打印"** 按钮
3. 会显示提示: "使用SDK打印测试页..."

**预期打印内容:**
```
        打印测试页
        (居中,粗体,大字体)

--------------------------------
设备测试
时间: 2025-11-10 17:xx:xx
--------------------------------
这是测试打印内容
数字: 1234567890
英文: ABCDEFGHIJKLMNOPQRSTUVWXYZ
小写: abcdefghijklmnopqrstuvwxyz
--------------------------------
中文测试: 你好世界
符号: !@#$%^&*()

    [12345678条形码]
    
(走纸,结束)
```

### 步骤4: 观察日志

在执行步骤2和步骤3时,请注意观察日志输出。

**连接时应该看到:**
```
D PuQuPrinterManager: 开始连接打印机: CD:AC:B0:F0:31:FC
D PuQuPrinterManager: 连接成功
```

**打印时应该看到:**
```
D PuQuPrinterManager: 开始打印测试页
D PuQuPrinterManager: 测试页打印完成
```

---

## 🐛 故障排查

### 问题1: 点击设备后没有弹出对话框
**原因**: 应用可能需要重启
**解决**: 重新安装APK或杀掉应用重新打开

### 问题2: 显示"连接失败 (SDK模式)"
**可能原因:**
- 打印机已被其他设备连接
- 打印机蓝牙未开启
- 距离太远或信号干扰

**解决方法:**
1. 确保打印机开机且蓝牙可见
2. 关闭其他可能连接打印机的应用
3. 靠近打印机再试

### 问题3: 连接成功但点击"测试打印"没反应
**检查:**
1. 连接状态是否显示 "已连接 (SDK模式 - 就绪)"
2. 查看logcat日志是否有错误

### 问题4: 打印机有响应但没打印内容
**可能原因:**
- 打印机缺纸
- 打印机头温度过高保护
- SDK内部错误

**解决:**
1. 检查打印纸
2. 等待打印机冷却
3. 查看logcat详细错误日志

---

## 📊 对比测试 (可选)

如果您还有GP系列打印机,可以测试标准模式:

1. 扫描并连接GP打印机(不是AQ开头的设备名)
2. 应该显示: "检测到非AQ设备,将使用标准模式连接"
3. 连接后状态显示: "就绪 (可以打印)" (没有SDK模式字样)
4. 点击测试打印,应该也能正常工作

这样可以验证两种模式都能正常工作!

---

## 📝 测试记录

请记录测试结果:

**AQ打印机测试:**
- [ ] 扫描到设备
- [ ] 成功连接(SDK模式)
- [ ] 成功打印测试页
- [ ] 打印内容完整清晰

**GP打印机测试(如有):**
- [ ] 扫描到设备  
- [ ] 成功连接(标准模式)
- [ ] 成功打印测试页
- [ ] 打印内容完整清晰

---

## 🎯 下一步

测试完成后,您可以:
1. 尝试连接/断开多次,测试稳定性
2. 修改 `PuQuPrinterManager.kt` 的 `printTestPage()` 方法自定义打印内容
3. 如果需要打印图片或更复杂的内容,参考SDK文档的其他API

---

**当前时间**: 2025-11-10 17:51
**您现在应该执行**: **步骤2 - 点击AQ-V258000114(BLE)设备进行连接** ⬅️
